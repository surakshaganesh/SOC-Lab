# DNS Traffic Anomaly Investigation

## Objective
Identify abnormal DNS traffic patterns using Splunk.

## Data Source
- Sourcetype: DNS_LOGS
- Index: main

## Fields Extracted
- src_ip
- src_port
- dest_ip
- dest_port
- fqdn

## Detection Queries

### 1. Top Source IP
index=main sourcetype=DNS_LOGS
| stats count by src_ip
| sort - count

### 2. Unique Domains Queried
index=main sourcetype=DNS_LOGS src_ip=<IP>
| stats dc(query) as unique_domains

### 3. Response Code Distribution
index=main sourcetype=DNS_LOGS src_ip=<IP>
| stats count by response_code

### 4. Traffic Over Time
index=main sourcetype=DNS_LOGS src_ip=<IP>
| timechart count span=5m

## Findings
- Highest traffic generated by: 10.10.117.210
- Total DNS Requests: 151886
- Observed response codes: NOERROR / NXDOMAIN
- Traffic pattern: (burst / consistent / abnormal)

## Conclusion
Traffic appears (benign / suspicious).
Further investigation recommended if NXDOMAIN rate is high.
