# DNS Traffic Anomaly Investigation

---

## ğŸ¯ Objective

Identify abnormal DNS traffic patterns using Splunk and detect potential malicious behavior such as DGA activity, botnet communication, or suspicious domain querying.

---

## ğŸ“‚ Data Source

- **Sourcetype:** DNS_LOGS
- **Index:** main

---

## ğŸ§¾ Fields Extracted

- src_ip
- src_port
- dest_ip
- dest_port
- fqdn
- response_code

---

## ğŸ” Detection Queries

### 1. Top Source IP

```
index=main sourcetype=DNS_LOGS
| stats count by src_ip
| sort - count
```

### 2. Unique Domains Queried

```
index=main sourcetype=DNS_LOGS src_ip=<IP>
| stats dc(fqdn) as unique_domains
```

### 3. Response Code Distribution

```spl
index=main sourcetype=DNS_LOGS src_ip=<IP>
| stats count by response_code
```

### 4. Traffic Over Time

```
index=main sourcetype=DNS_LOGS src_ip=<IP>
| timechart count span=5m
```

### 5. Rare Domain Detection

```
index=main sourcetype=DNS_LOGS
| stats count by fqdn
| sort count
```
---

## ğŸ“… Latest Drill (21-02-2026)

Todayâ€™s focus was on advanced DNS behavioral indicators:

### âœ” NXDOMAIN Response Analysis
- Identified domains returning NXDOMAIN
- Studied how high NXDOMAIN ratio indicates DGA activity
- Analyzed response code distribution per source IP

### âœ” Long Domain Detection
- Investigated unusually long FQDNs
- Studied DGA-generated domain patterns

### âœ” Rare Domain Analysis
- Checked low-frequency domains
- Identified potentially newly generated or suspicious domains

### âœ” Unique Domains per IP
- Measured number of unique domains queried by single IP
- Investigated bot-like behavior patterns

These indicators strengthen DNS-based anomaly detection capability in SOC environments.

---

## Findings
- Highest traffic generated by: 10.10.117.210
- Total DNS Requests: 151886
- Observed response codes: NOERROR / NXDOMAIN
- Traffic pattern: (burst / consistent / abnormal)
- NXDOMAIN rate: (Calculate %)

## Conclusion
Traffic appears (benign / suspicious).
Further investigation recommended if NXDOMAIN rate is high.
